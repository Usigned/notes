# 第二章 线性方程组的直接解法

>  直接解法指，不考虑舍入误差，经过有限次算数运算能求出方程组的精确解

Cramer法则是一种不实用的直接解法

时间复杂度
$$
(n+1)*n!
$$


## Gauss消去法

### 顺序Gauss消去

1. 消元，化为上三角型
2. 回代，得到解

**算法描述**：

设方程的增广矩阵$(A,b)$是一个n*(n+1)的矩阵

> 1. i 循环从 0 到 n-2
>
> 2. if a\[i\]\[i\] == 0，退出，顺序Gauss无法求解
>
> 3. j 循环从 i+1 到 n-1
>
> 4. $l_j = - a[j][i]/a[i][i]$
>
> 5. $a[j] += lj*a[j]$
> 6. 循环结束，回代

**时间复杂度分析**：

- 消元过程：
  - 第1步：$(n-1)*n +n-1 = n^2-1$ 
  - 第2步：$(n-1)^2-1$
  - 第n-1步：$2^2-1$

- 回代
  $$
  \sum_1^{n} = n(n+1)/2
  $$
  
- 总计：
  $$
  \frac 13(n^3+3n^2-n) = O(n^3)
  $$
  
- 

顺序高斯消去要求主元素不为0，即**原方程系数矩阵顺序主子式均不为零**

### 列主元Gauss消去

在每一步消元过程中，选择主元所在的列主元素最大的的元素作为主元素

**算法描述**：

设方程的增广矩阵$(A,b)$是一个n*(n+1)的矩阵

> 1. i 循环从 0 到 n-2
> 2. <font color = 'red'>k 循环从 i+1 到 n-1, 寻找$Max(a[k][i])$，将第 j 行与第 i 行互换</font>
> 3. j 循环从 i+1 到 n-1
> 4. $l_j = - a[j][i]/a[i][i]$
> 5. $a[j] += lj*a[j]$
> 6. 循环结束，回代

**时间复杂度分析**：

- 增加的寻找Max的过程代价很小，可以认为时间复杂度和顺序高斯相近，但大幅度提高了算法的稳定性
- 列主元高斯消去要求$|A| ！= 0$

## 矩阵三角分解

### Doolittle分解

#### Gauss消去的矩阵表示

> 初等行变换相当于对原矩阵左乘一个初等矩阵

设n阶方阵A的各阶顺序主子式不为零，则<font color ='red'>存在唯一</font>**单位**下三角矩阵L和上三角矩阵U使A=LU （充分条件）

$$
A=LU
$$

其中 L为单位上三角矩阵，U的主对角元即为主元
$$
L = \left[
\begin{matrix}
 1      &       &  &       \\
 l_{21}      & 1     & &       \\
 \vdots & \vdots & \ddots & \vdots \\
 l_{n1}      & l_{n2}      & \cdots & 1      \\
\end{matrix}
\right],U = \left[
\begin{matrix}
 u_{11}      & u_{12}      &\cdots  & u_{1n}      \\
       & u_{22}     &\cdots &      u_{2n} \\
  &  & \ddots & \vdots \\
       &       &  & u_{nn}      \\
\end{matrix}
\right]
$$
第k步计算时，计算$L=(l_{ij}),U=(u_{ij})$中的$l_{kj},u_{ik}$，即$L$的第k行和$U$的第k列

**算法描述**：

$A=(a_{ij})$为矩阵的系数矩阵

> 1. k从1循环到n
> 2. $l_{kk} = 1,u_{1k} = a_{1k}$
> 3. $l_{k1}*u_{11} = a_{k1},l_{k2}*u_{22}+l_{k_1}*u_{12} = a_{k2},...$
> 4. $u_{1k}*l_{11}=a_{1k},u_{1k}*l_{21}+u_{2k}*l_{22} = a_{2k},...$
> 5. 得到$L,U$回代$Ly = b, Ux= y

**相比于Gauss消去的优势**

解同系数矩阵方程组时，只用进行一次矩阵分解

实例：使用$AX=E$ 即 $A(x_1,x_2,...,x_n) = (e_1,e_2,...,e_3)$，求$A^{-1}$，即解n个方程
$$
Ax_i = e_i
$$
**算法复杂度**

- 当直接一个方程组时和Gauss消去相当
- 当解n个相同系数矩阵方程时
  - Gauss消去时间复杂度$O(n^4)$
  - doolittle分解复杂度为$O(n^3)$

### 列主元分解

类似列主元高斯消去的思路，每一步进行三角分解前，选取主元最大的行并进行交换，**同时对b对应的行也需要进行交换**

**算法描述**

>1. k从1循环到n
>2. <font color='red'>选取A中主元素最大的行，与第k行进行交换，同时b中对应的行交换</font>
>3. $l_{kk} = 1,u_{1k} = a_{1k}$
>4. $l_{k1}*u_{11} = a_{k1},l_{k2}*u_{22}+l_{k_1}*u_{12} = a_{k2},...$
>5. $u_{1k}*l_{11}=a_{1k},u_{1k}*l_{21}+u_{2k}*l_{22} = a_{2k},...$
>6. 得到$L,U$回代$Ly = b, Ux= y$

**相比于不列主元的优势**

只需要A满秩即可，对各阶顺序主子式无要求

### 平方根法

设***A***为对称正定矩阵，显然***A***可以进行doolittle分解$A=LU$

由于A对称且doolittle分解唯一性，可推：
$$
A = LDL^T = (LD^{\frac 12}D^{\frac 12}L^T) = GG^T
$$
因为A正定，故$D^{\frac 12}$的对角元一定为实数，一般$D^{\frac 12}$的对角元取正数

上述过程称为，对称正定矩阵的乔列斯基分解

> 当矩阵A对称正定时，必存在cholesky分解，$A=GG^T$，其中G为满秩的下三角矩阵

**算法描述**

>1. 和直接三角分解相似，以行--列模式进行分解
>2. 回代$Gy=b，G^Tx=y$

**相比于LU分解优势**

算法的时间复杂度、空间复杂度是doolittle分解的一半，且cholesky分解具有数值稳定性（对各阶顺序主子式无要求）

### 追赶法

研究对象：系数矩阵A为三对角矩阵

三对角矩阵A的各顺序主子式都不为零的一个充分条件是：A是对角占优的

当A各阶顺序主子式都不为零时，存在分解$A=TM$，其中$T$为下三角矩阵，$M$为单位上三角矩阵，称此分解为A的Crout分解

追赶法：对三对角矩阵进行克劳特分解，再进行回代过程，称为解三对角矩阵的追赶法