# 第二章 线性方程组的直接解法

>  直接解法指，不考虑舍入误差，经过有限次算数运算能求出方程组的精确解

Cramer法则是一种不实用的直接解法

时间复杂度
$$
(n+1)*n!
$$


## Gauss消去法

### 顺序Gauss消去

1. 消元，化为上三角型
2. 回代，得到解

**算法描述**：

设方程的增广矩阵$(A,b)$是一个n*(n+1)的矩阵

> 1. i 循环从 0 到 n-2
>
> 2. if a\[i\]\[i\] == 0，退出，顺序Gauss无法求解
>
> 3. j 循环从 i+1 到 n-1
>
> 4. $l_j = - a[j][i]/a[i][i]$
>
> 5. $a[j] += lj*a[j]$
> 6. 循环结束，回代

**时间复杂度分析**：

- 消元过程：
  - 第1步：$(n-1)*n +n-1 = n^2-1$ 
  - 第2步：$(n-1)^2-1$
  - 第n-1步：$2^2-1$

- 回代
  $$
  \sum_1^{n} = n(n+1)/2
  $$
  
- 总计：
  $$
  \frac 13(n^3+3n^2-n) = O(n^3)
  $$
  
- 

顺序高斯消去要求主元素不为0，即**原方程系数矩阵顺序主子式均不为零**

### 列主元Gauss消去

在每一步消元过程中，选择主元所在的列主元素最大的的元素作为主元素

**算法描述**：

设方程的增广矩阵$(A,b)$是一个n*(n+1)的矩阵

> 1. i 循环从 0 到 n-2
> 2. <font color = 'red'>k 循环从 i+1 到 n-1, 寻找$Max(a[k][i])$，将第 j 行与第 i 行互换</font>
> 3. j 循环从 i+1 到 n-1
> 4. $l_j = - a[j][i]/a[i][i]$
> 5. $a[j] += lj*a[j]$
> 6. 循环结束，回代

**时间复杂度分析**：

- 增加的寻找Max的过程代价很小，可以认为时间复杂度和顺序高斯相近，但大幅度提高了算法的稳定性
- 列主元高斯消去要求$|A| ！= 0$

## 矩阵三角分解

### Doolittle分解

**Gauss消去的矩阵表示**

> 初等行变换相当于对原矩阵左乘一个初等矩阵

设n阶方阵A的各阶顺序主子式不为零，则<font color ='red'>存在唯一</font>**单位**下三角矩阵L和上三角矩阵U使A=LU （充分条件）

$$
A=LU
$$

其中 L为单位上三角矩阵，U的主对角元即为主元
$$
L = \left[
\begin{matrix}
 1      &       &  &       \\
 l_{21}      & 1     & &       \\
 \vdots & \vdots & \ddots & \vdots \\
 l_{n1}      & l_{n2}      & \cdots & 1      \\
\end{matrix}
\right],U = \left[
\begin{matrix}
 u_{11}      & u_{12}      &\cdots  & u_{1n}      \\
       & u_{22}     &\cdots &      u_{2n} \\
  &  & \ddots & \vdots \\
       &       &  & u_{nn}      \\
\end{matrix}
\right]
$$
第k步计算时，计算$L=(l_{ij}),U=(u_{ij})$中的$l_{kj},u_{ik}$，即$L$的第k行和$U$的第k列

**算法描述**：

$A=(a_{ij})$为矩阵的系数矩阵

> 1. k从1循环到n
> 2. $l_{kk} = 1,u_{1k} = a_{1k}$
> 3. $l_{k1}*u_{11} = a_{k1},l_{k2}*u_{22}+l_{k_1}*u_{12} = a_{k2},...$
> 4. $u_{1k}*l_{11}=a_{1k},u_{1k}*l_{21}+u_{2k}*l_{22} = a_{2k},...$
> 5. 得到$L,U$回代$Ly = b, Ux= y$

**相比于Gauss消去的优势**

解同系数矩阵方程组时，只用进行一次矩阵分解

实例：使用$AX=E$ 即 $A(x_1,x_2,...,x_n) = (e_1,e_2,...,e_3)$，求$A^{-1}$，即解n个方程
$$
Ax_i = e_i
$$
**算法复杂度**

- 当直接一个方程组时和Gauss消去相当
- 当解n个相同系数矩阵方程时
  - Gauss消去时间复杂度$O(n^4)$
  - doolittle分解复杂度为$O(n^3)$

### 列主元分解

类似列主元高斯消去的思路，每一步进行三角分解前，选取主元最大的行并进行交换，**同时对b对应的行也需要进行交换**

**算法描述**

>1. k从1循环到n
>2. <font color='red'>选取A中主元素最大的行，与第k行进行交换，同时b中对应的行交换</font>
>3. $l_{kk} = 1,u_{1k} = a_{1k}$
>4. $l_{k1}*u_{11} = a_{k1},l_{k2}*u_{22}+l_{k_1}*u_{12} = a_{k2},...$
>5. $u_{1k}*l_{11}=a_{1k},u_{1k}*l_{21}+u_{2k}*l_{22} = a_{2k},...$
>6. 得到$L,U$回代$Ly = b, Ux= y$

**相比于不列主元的优势**

只需要A满秩即可，对各阶顺序主子式无要求

### 平方根法（Cholesky分解）

设***A***为对称正定矩阵，显然***A***可以进行doolittle分解$A=LU$

由于A对称且doolittle分解唯一性，可推：
$$
A = LDL^T = (LD^{\frac 12}D^{\frac 12}L^T) = GG^T
$$
因为A正定，故$D^{\frac 12}$的对角元一定为实数，一般$D^{\frac 12}$的对角元取正数

上述过程称为，对称正定矩阵的乔列斯基分解

> 当矩阵A对称正定时，必存在cholesky分解，$A=GG^T$，其中G为满秩的下三角矩阵

**算法描述**

>1. 和直接三角分解相似，以行--列模式进行分解
>2. 回代$Gy=b，G^Tx=y$

**相比于LU分解优势**

算法的时间复杂度、空间复杂度是doolittle分解的一半，且cholesky分解具有数值稳定性（对各阶顺序主子式无要求）

### 追赶法（Crout分解）

研究对象：系数矩阵A为三对角矩阵

三对角矩阵A的各顺序主子式都不为零的一个充分条件是：A是对角占优的

当A各阶顺序主子式都不为零时，存在分解$A=TM$，其中$T$为下三角矩阵，$M$为单位上三角矩阵，称此分解为A的Crout分解

追赶法：对三对角矩阵进行克劳特分解，再进行回代过程，称为解三对角矩阵的追赶法

- [ ] **<font color ='red'>相比于doolittle分解的优势?</font>**

## 向量和矩阵范数

衡量向量和矩阵"大小"

### 向量范数

**向量范数定义：**

> $|\cdot|$是向量空间$R^n$上的实值函数，若满足条件：
>
>   		1. 非负性：$|x|>=0$ ，且$|x|=0$当且仅当$x=0$
>                 		2. 齐次性：$|\alpha x|=|\alpha||x|$
>             		3. 三角不等式:$|x|+|y|<=|x+y|$
>
> 则称函数$|\cdot|$为空间$R^n$上的一个向量范数，|x|为向量x的范数

**常用向量范数：**

1. 1-范数：$|x|_1=\sum_1^n|x_i|$
2. 2-范数：$|x|_2=(\sum_1^n|x_i|^2)^{1/2}$
3. 无穷范数：$|x|_\infin = Max_1^n(|x_i|)$
4. 统一形式---p范数：$|x|_p=(\sum_1^n|x_i|^p)^{1/p}$

**补充：加权范数**

定义：

> $x \in R^{n*n},W \in R^{n*n}$，且为非奇异，则：
> $$
> ||x||_w = ||Wx||(其中||x||是x的某种范数)
> $$
> 则$||\cdot||_w必为向量范数$

*显然，同一向量对应的不同范数值不一定相同*

**补充：范数的连续性**

设$N(x)=||x||$是$R^{nn}$上的任意向量范数，则$N(x)$是$x$的分量$x_1,x_2,...,x_n$的连续函数

**范数等价性**

设$||\cdot||_\alpha，||\cdot||_\beta$为$R^{nn}$上的范数，则存在$m，M>0$，使得
$$
m||x||_\alpha \leq ||x||_\beta \leq M||x||_\alpha,\forall x \in R^{n \times n}
$$
*注意：只要给定$R^{n \times n}$*上的两个范数$||\cdot||_\alpha,||\cdot||_\beta$，$M，m$即确定，和$x$无关

**向量序列的收敛**

设$x^{(k)}=(x_1^{(k)},x_2^{(k)},...,x_n^{(n)})$以及常向量$x^*=(x_1^*,x_2^*,...,x_n^*)$，若
$$
\lim_{x\to\infin}||x^{(k)}-x^*||=0
$$
则称向量序列${x^{(k)}}$收敛于向量$x^*$，记作：
$$
\lim_{k \to \infin} x^{(k)} = x^*
$$

### 矩阵范数

**性质：**设$|\cdot|$是以n阶方阵为自变量的**实值函数**

1. $|A|\geq 0，且当|A|=0当且仅当A=O$
2. $|\alpha A|=|\alpha||A|$
3. $|A+B|\leq|A|+|B|$
4. *相容性*：$|AB|\leq|A||B|$

**常用范数**

1. 1-范数（列范数）：$|A|_1 = max_{j=1}^n\sum_{i=1}^n|a_{ij}|$

2. $\infin$-范数（行范数）：$|A|_\infin = max_{i=1}^n\sum_{j=1}^n|a_{ij}|$

3. 2-范数（谱范数）：$|A|_2 = \sqrt {max\lambda(A^TA)}$

   *矩阵特征值的集合叫做谱*

4. F-范数（Fronbenius)：$|A|_F = \sqrt {\sum_1^n\sum_1^na_{ij}^2} = \sqrt{tr(A^TA)}$

**矩阵算子范数定义**

$|\cdot|是一种范数，则定义$
$$
|A| = max_1^n \frac {|Ax|} {|x|}
$$
称之为由向量范数派生出的**矩阵算子范数**

*使用向量范数定义的矩阵算子范数和矩阵范数是相同的*

性质：
$$
|A||x| \geq |Ax|,\forall x \in R^n
$$
把满足此式的矩阵范数称为与**向量范数相容的矩阵范数**

*PS*：*矩阵算子范数一定与向量范数相容*，*但与向量相容的范数不一定是矩阵算子范数*

**算子范数一些结论**

- 矩阵范数$||\cdot||_p,p=1,2,\infin$是对应向量范数的派生出的算子范数
- $||E|| = 1$
- $||\cdot||_F$不是算子范数，因为$||E||_F = \sqrt n$，但其与向量2-范数相容
- 范数的正交不变性：对任意的A，和其同阶的正交矩阵Q
  - $||AQ||_F = ||QA||_F =||A||_F$
  - $||AQ||_2 = ||QA||_2 =||A||_2$

**矩阵范数的等价性**

同向量范数等价性

**矩阵数列收敛定义**

同向量序列收敛定义

### **范数和特征值间的关系**

由特征值定义
$$
\lambda x = Ax =>
||\lambda x|| = ||Ax|| =>
|\lambda|\cdot||x|| = ||Ax||\le||A||\cdot||x||\\
$$
可得
$$
|\lambda|\le||A||
$$
定义矩阵的谱半径为矩阵最大特征值（谱）：
$$
\rho(A) = Max(\lambda_A)
$$
故对于与向量范数相容的矩阵范数必有
$$
\rho(A)\le||A||
$$
**推广**

对于任意满足矩阵范数相容性($|AB|\le|A||B|$)的矩阵范数，必有
$$
\rho(A)\le||A||
$$
证明：
$$
\lambda x=Ax=>\lambda xx'=Axx'=>|\lambda xx'|=|Axx'|\le|A||xx'|
$$
**本书中矩阵范数都是向量相容的**

$\rho(A)$是$|A|$的下确界

## 线性方程组固有性态与误差分析

### 线性方程组固有性态

- 病态方程、病态矩阵

定义矩阵A的条件数
$$
Cond(A) = ||A||\cdot||A^{-1}||
$$
特殊的有当$A=A'$时
$$
Cond_2(A)=\frac {\max(|\lambda_A|)}{\min(|\lambda_A|)}
$$
**条件数越大，误差越大**

### **预条件和迭代改善**

#### 预条件处理

1. $Ax=b$同时左乘$P$

2. 同时左右乘$Ax=b => PAQ(Q^{-1}x)=Pb$

#### 迭代改善

解方程得到近似解$x^{(1)}$
$$
r^{(1)} = b-Ax^{(1)}
$$
再解
$$
Ax=r^{(1)}
$$
得到解$x^{(2)}$，迭代改善解为$x=x^{(1)}+x^{(2)}$